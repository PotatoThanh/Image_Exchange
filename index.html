<!DOCTYPE html>
<html>

<head>
  <title>File Upload with Socket.IO</title>
</head>
<script src="/socket.io/socket.io.js"></script>

<body>
  <h1>Select a Folder</h1>
  <input type="file" id="fileInput" webkitdirectory directory multiple />
  <button onclick="uploadFile()">Upload</button>
</body>

<script>
  var socket = io();
  function uploadFile() {
    const fileInput = document.getElementById('fileInput');
    const validExtensions = ['.pdf','.dcm', '.jpg', '.png']; // Add your desired file extensions
    for(let i = 0; i < fileInput.files.length; i++) {
        console.log(fileInput.files[i].webkitRelativePath);
    }
    for (const file of fileInput.files) {
      if (validExtensions.some(extension => file.name.toLowerCase().endsWith(extension))) {
        console.log(file);

        const filename = file.webkitRelativePath;

        const reader = new FileReader();
        reader.onload = (e) => {
          const fileData = e.target.result;
          socket.emit("sendToServer", { 'file': fileData, 'filename': filename });
        };
        reader.readAsArrayBuffer(file);
      } else {
        console.log('Skipping file with invalid extension:', file.name);
      }
    }
  }


</script>

</html>